{% extends "layout.html" %}
{% block content %}
	 <h2>Edit Asset</h2>
  <form action="{{ url_for('edit_asset_submit', sitename=site.name, assetname=asset.name) }}" method=post>
    <table>
      <tr>
        <td style="width:250px"><h4>Name:</h4></td>
        <td><div class="mdl-textfield mdl-js-textfield shiftdown">
            <input class="mdl-textfield__input" type="text" name="name" autocomplete="off" id="name" value='{{asset.name}}'>
            <label class="mdl-textfield__label" for="name"></label>
        </div></td>
      </tr>
      <tr>
      <td><h4>Location:</h4></td>
        <td><div class="mdl-textfield mdl-js-textfield shiftdown">
            <input class="mdl-textfield__input" type="text" name="location" autocomplete="off" id="location" value='{{asset.location}}'>
            <label class="mdl-textfield__label" for="location"></label>
        </div></td>
      </tr>
      <tr>
        <td><h4>Group:</h4></td>
        <td><div class="mdl-textfield mdl-js-textfield shiftdown">
            <input class="mdl-textfield__input" type="text" name="group" autocomplete="off" id="group" value='{{asset.group}}'>
            <label class="mdl-textfield__label" for="group"></label>
        </div></td>
      </tr>
      <tr>
        <td><h4>Priority:</h4></td>
        <td><div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label getmdl-select getmdl-select__fix-height shiftdown">
          <input class="mdl-textfield__input" type="text" id="priority_list" name="priority" value="{{asset.priority}}" readonly tabIndex="-1">
          <label for="priority_list">
            <i class="mdl-icon-toggle__label material-icons">keyboard_arrow_down</i>
          </label>
          <ul for="priority_list" class="mdl-menu mdl-menu--bottom-left mdl-js-menu">
            {% for i in range(0,10) %}
              <li class="mdl-menu__item" data-val="{{i}}">{{i}}</li>
            {% endfor %}
          </ul>
        </div></td>
      </tr>
    </table>
    <br>

    <h4>Process Functions:</h4>
      <table>
        {% for function in asset.functions %}
          <tr><td>
            {{function.name}}
            <input type=hidden name="function" value="{{function.name}}"/>
          </td></tr>
        {% endfor %}
      </table>
    <br>

    <h4>Points:</h4>
    <table>
    	{% for point in asset.points %}
    		<tr>
    			<td style="width:250px"><input type=hidden class="point" name='point{{loop.index}}' value='{{point.type.name}}'/> {{point.type.name}}</td>
    			<td><div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label getmdl-select getmdl-select__fix-height">
            <input class="mdl-textfield__input" type="text" id='log{{loop.index}}' name='log{{loop.index}}'
              {% for log in logs %}
                {% if point.loggedentity_id == log.id %}value='{{log.path}}'{% endif %}
              {% endfor %}
            readonly tabIndex="-1">
            <label for='log{{loop.index}}'>
              <i class="mdl-icon-toggle__label material-icons">keyboard_arrow_down</i>
            </label>
            <ul for='log{{loop.index}}' class="mdl-menu mdl-menu--bottom-left mdl-js-menu">
              {% for log in logs %}
                <li class="mdl-menu__item" data-val="{{log.path}}">{{log.path}}</li>
              {% endfor %}
            </ul>
          </div></td>
    		</tr>
    	{% endfor %}
    </table>
    <br>

    <h4>Algorithms:</h4>
    <table>
    	{% for algorithm in asset.algorithms %}
    		<tr><td>
          <label class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect" for="algorithm' + i + '">
            <input type="checkbox" name="algorithm" value='{{algorithm.descr}}' class="mdl-checkbox__input" {% if not algorithm in asset.exclusions %}checked{% endif %}/>
            <span class="mdl-checkbox__label">{{algorithm.descr}}</span>
          </label>
    		</td></tr>
    	{% endfor %}
    </table>
    <br><br>

    <input type=submit value=Submit class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">

  </form>

  <!-- Material design auto 'upgrades' the elements, causing selectedIndex to revert to not -1. Hacky method here to delay this until after MDL is done upgrading stuff-->
  <script type="text/javascript">
    $(function() {
      setTimeout(function() {
        {% for point in asset.points %}
          {% if point.loggedentity_id == None %}
            $('#log{{loop.index}}').prop("selectedIndex", -1);
          {% endif %}
        {% endfor %}
      }, 50);
    });
  </script>

{% endblock %}