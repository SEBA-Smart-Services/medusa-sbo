<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Medusa</title>

    <!-- CSS Rules -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/getmdl-select.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/material.components.ext.min.css') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.green-blue.min.css" />
    <link rel="shortcut icon" href="{{ url_for('static', filename='img/favicon.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/jquery.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/list.min.js') }}"></script>
    <script defer type="text/javascript" src="{{ url_for('static', filename='js/material.components.ext.min.js') }}"></script>
    <script defer type="text/javascript" src="{{ url_for('static', filename='js/getmdl-select.min.js') }}"></script>
    <script type=text/javascript>
      $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
    </script>

    <!-- refresh pages every 5 min - maybe better way to keep information up to date? -->
    <!-- meta http-equiv="refresh" content="300" /-->

    <!-- Display flashes -->
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <script>
          var messages = {{ messages | safe }};
          for (var i=0; i<messages.length; i++) {
            alert(messages[i]);
          }
        </script>
      {% endif %}
    {% endwith %}

    {% block head %}{% endblock %}

    <!-- Import macros -->
    {% import 'macros.html' as macros %}

  </head>

  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
          <span class="mdl-layout-title">
            {% if allsites == True %}
            <h3>Sites Overview</h3>
            {% else %}
            <h3>{{site.name}}</h3>
            {% endif %}
          </span>
          <div class="mdl-layout-spacer"></div>
          <!-- Navigation -->
          <nav class="mdl-navigation">
            {% if allsites == True %}
              <a class="mdl-navigation__link medusa-app-link" href="/site/all/dashboard">Dashboard</a>
              <a class="mdl-navigation__link" href="/site/all/weather">Weather</a>
              <a class="mdl-navigation__link" href="/site/all/sites">Sites</a>
              <a class="mdl-navigation__link" href="/site/all/issues">Issues</a>
              <a class="mdl-navigation__link" href="/site/all/issue-chart">Issue Chart</a>
              <a class="mdl-navigation__link" href="/site/all/map">Map</a>
              <a class="mdl-navigation__link" href="/site/all/add_site">Add Site</a>
            {% else %}
              <a class="mdl-navigation__link" href="/site/{{site.name}}/dashboard">Dashboard</a>
              <a class="mdl-navigation__link" href="/site/{{site.name}}/issues">Issues</a>
              <a class="mdl-navigation__link" href="/site/{{site.name}}/assets">Assets</a>
              <a class="mdl-navigation__link" href="/site/{{site.name}}/add">Add Asset</a>
              <a class="mdl-navigation__link" href="/site/{{site.name}}/config">Site Config</a>
              <a class="mdl-navigation__link" href="/site/all">All Sites</a>
            {% endif %}
            {% if current_user.is_authenticated %}
              {% if current_user.has_role('admin') %}
                <a class="mdl-navigation__link" href="/admin/site">Admin</a>
              {% endif %}
              <a class="mdl-navigation__link" href="{{ url_for('user.logout') }}">{{ current_user.username }} &nbsp;|&nbsp; Sign out</a>
            {% else %}
              <a class="mdl-navigation__link" href="{{ url_for('user.login') }}">Sign in</a>
            {% endif %}
          </nav>
        </div>
      </header>
      <main class="mdl-layout__content" style="flex: 1 0 auto;">
        {% block layout %}{% endblock %}
      </main>
      <footer class="mdl-mini-footer">
        <div class="mdl-mini-footer__left-section">
          <div class="mdl-logo">More Information</div>
          <ul class="mdl-mini-footer__link-list">
            <li><a href="#">Help</a></li>
            <li><a href="#">Privacy & Terms</a></li>
          </ul>
          &copy; Copyright Schneider Electric 2017
        </div>
      </footer>
    </div>
  </body>
</html>
